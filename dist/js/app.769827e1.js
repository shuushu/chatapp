(function(t){function e(e){for(var a,r,i=e[0],u=e[1],s=e[2],m=0,l=[];m<i.length;m++)r=i[m],o[r]&&l.push(o[r][0]),o[r]=0;for(a in u)Object.prototype.hasOwnProperty.call(u,a)&&(t[a]=u[a]);d&&d(e);while(l.length)l.shift()();return c.push.apply(c,s||[]),n()}function n(){for(var t,e=0;e<c.length;e++){for(var n=c[e],a=!0,r=1;r<n.length;r++){var i=n[r];0!==o[i]&&(a=!1)}a&&(c.splice(e--,1),t=u(u.s=n[0]))}return t}var a={},r={app:0},o={app:0},c=[];function i(t){return u.p+"js/"+({}[t]||t)+"."+{"chunk-04869cf8":"80f88694","chunk-0714cbc6":"65170d3e","chunk-2567a75f":"a471e370","chunk-50dcc184":"9d020e49","chunk-bf8b74c8":"a0350c84","chunk-e123192c":"96bca734"}[t]+".js"}function u(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,u),n.l=!0,n.exports}u.e=function(t){var e=[],n={"chunk-04869cf8":1,"chunk-0714cbc6":1,"chunk-2567a75f":1,"chunk-50dcc184":1,"chunk-bf8b74c8":1,"chunk-e123192c":1};r[t]?e.push(r[t]):0!==r[t]&&n[t]&&e.push(r[t]=new Promise(function(e,n){for(var a="css/"+({}[t]||t)+"."+{"chunk-04869cf8":"5c90e71b","chunk-0714cbc6":"08b4f44f","chunk-2567a75f":"7cca2a82","chunk-50dcc184":"7f46e174","chunk-bf8b74c8":"6a60ac62","chunk-e123192c":"3f5164e3"}[t]+".css",o=u.p+a,c=document.getElementsByTagName("link"),i=0;i<c.length;i++){var s=c[i],m=s.getAttribute("data-href")||s.getAttribute("href");if("stylesheet"===s.rel&&(m===a||m===o))return e()}var l=document.getElementsByTagName("style");for(i=0;i<l.length;i++){s=l[i],m=s.getAttribute("data-href");if(m===a||m===o)return e()}var d=document.createElement("link");d.rel="stylesheet",d.type="text/css",d.onload=e,d.onerror=function(e){var a=e&&e.target&&e.target.src||o,c=new Error("Loading CSS chunk "+t+" failed.\n("+a+")");c.request=a,delete r[t],d.parentNode.removeChild(d),n(c)},d.href=o;var f=document.getElementsByTagName("head")[0];f.appendChild(d)}).then(function(){r[t]=0}));var a=o[t];if(0!==a)if(a)e.push(a[2]);else{var c=new Promise(function(e,n){a=o[t]=[e,n]});e.push(a[2]=c);var s,m=document.createElement("script");m.charset="utf-8",m.timeout=120,u.nc&&m.setAttribute("nonce",u.nc),m.src=i(t),s=function(e){m.onerror=m.onload=null,clearTimeout(l);var n=o[t];if(0!==n){if(n){var a=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src,c=new Error("Loading chunk "+t+" failed.\n("+a+": "+r+")");c.type=a,c.request=r,n[1](c)}o[t]=void 0}};var l=setTimeout(function(){s({type:"timeout",target:m})},12e4);m.onerror=m.onload=s,document.head.appendChild(m)}return Promise.all(e)},u.m=t,u.c=a,u.d=function(t,e,n){u.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},u.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},u.t=function(t,e){if(1&e&&(t=u(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(u.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)u.d(n,a,function(e){return t[e]}.bind(null,a));return n},u.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return u.d(e,"a",e),e},u.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},u.p="/chat/",u.oe=function(t){throw console.error(t),t};var s=window["webpackJsonp"]=window["webpackJsonp"]||[],m=s.push.bind(s);s.push=e,s=s.slice();for(var l=0;l<s.length;l++)e(s[l]);var d=m;c.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"1a80":function(t,e,n){},"325c":function(t,e,n){"use strict";n.d(e,"b",function(){return a}),n.d(e,"d",function(){return o}),n.d(e,"c",function(){return r}),n.d(e,"a",function(){return c});n("a481"),n("3b2b");var a=function(t){var e=/(https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9]+\.[^\s]{2,}|www\.[a-zA-Z0-9]+\.[^\s]{2,})/gi,n=new RegExp(e);return n.test(t)},r=function(t){var e=/(https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9]+\.[^\s]{2,}|www\.[a-zA-Z0-9]+\.[^\s]{2,})/gi;return t.replace(e,function(t){return'<a href="'+t+'" target="_blank">'+t+"</a>"})},o=function(t){var e=t.getMonth()+1,n=t.getDate();return[t.getFullYear(),(e>9?"":"0")+e,(n>9?"":"0")+n].join("")},c=function(t,e){var n=document.querySelector("html"),a=document.querySelector("body"),r=e.scrollHeight;return(a.scrollTop||n.scrollTop)+t>=r-t}},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("f751"),n("097d");var a,r=n("2b0e"),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:t.classes.isOnepage,attrs:{id:"app"}},[this.onepage?t._e():n("header",{attrs:{id:"header"}},[n("transition",{attrs:{name:"head"}},["message"===this.$route.name?n("MsgHeader",{attrs:{alarm:t.alarm.total}}):n("Header",{attrs:{alarm:t.alarm.total,name:this.$route.name}})],1)],1),n("transition",{attrs:{name:t.name}},[n("router-view")],1),this.onepage?t._e():n("footer",{attrs:{id:"footer"}},[n("transition",{attrs:{name:"msgform"}},["message"===this.$route.name?n("MessageForm"):n("Footer")],1)],1),t.popupAlert.isShow?n("md-dialog-alert",{attrs:{id:"popupAlert","md-active":t.popupAlert.isShow,"md-content":t.popupAlert.message,"md-confirm-text":"확인"},on:{"update:mdActive":function(e){return t.$set(t.popupAlert,"isShow",e)},"update:md-active":function(e){return t.$set(t.popupAlert,"isShow",e)}}}):t._e(),t.popupConfirm.isShow?n("md-dialog-confirm",{attrs:{id:"popupConfirm","md-active":t.popupConfirm.isShow,"md-title":t.popupConfirm.name,"md-content":t.popupConfirm.message},on:{"update:mdActive":function(e){return t.$set(t.popupConfirm,"isShow",e)},"update:md-active":function(e){return t.$set(t.popupConfirm,"isShow",e)},"md-confirm":function(e){return t.popupConfirm.action(t.popupConfirm)}}}):t._e()],1)},c=[],i=(n("6762"),n("7f7f"),n("cebc")),u=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("md-toolbar",{staticClass:"md-primary"},[n("div",{staticClass:"md-toolbar-row"},[n("div",{staticClass:"md-toolbar-section-start"},[n("md-button",{staticClass:"md-icon-button",on:{click:t.historyBack}},[n("md-icon",[t._v("arrow_back")])],1)],1),t.name?n("h1",{staticClass:"head-title"},[t._v(t._s(t.name.toUpperCase()))]):t._e(),n("div",{staticClass:"md-toolbar-section-end"},[t.alarm>0?n("md-badge",{attrs:{"md-content":t.alarm}},[n("md-button",{staticClass:"md-icon-button"},[n("md-icon",[t._v("notifications")])],1)],1):t._e(),n("md-button",{staticClass:"md-icon-button",on:{click:t.logout}},[n("md-icon",[t._v("highlight_off")])],1)],1)])])},s=[],m=(n("c5f6"),{name:"Header",data:function(){return{selectedEmployee:""}},props:{alarm:{default:0,type:Number},name:{type:String}},methods:{historyBack:function(){this.$router.go(-1)},logout:function(){this.$run("dialogConfirm",{name:"로그아웃",message:"로그아웃 하시겠습니까?",action:this.actionLogout})},actionLogout:function(){var t=this;this.$run("logout").then(function(e){t.$run("dialogAlert",{message:e?"로그아웃 되었습니다":e.code})})}}}),l=m,d=n("2877"),f=Object(d["a"])(l,u,s,!1,null,null,null),h=f.exports,p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("md-bottom-bar",{attrs:{"md-type":"shift","md-sync-route":""}},[n("md-bottom-bar-item",{attrs:{to:"/member",id:"bottom-bar-item-home","md-label":"MEMBER","md-icon":"people"}}),n("md-bottom-bar-item",{attrs:{to:"/list",id:"bottom-bar-item-pages","md-label":"LIST","md-icon":"chat"}}),n("md-bottom-bar-item",{attrs:{to:"/ready",id:"bottom-bar-item-posts","md-label":"rental","md-icon":"book"}}),n("md-bottom-bar-item",{attrs:{to:"/ready",id:"bottom-bar-item-favorites","md-label":"history","md-icon":"favorite"}})],1)},E=[],b={name:"Footer"},_=b,v=(n("e7bd"),Object(d["a"])(_,p,E,!1,null,"73561f48",null)),g=v.exports,S=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"form-area"},[t.thumb?n("div",{staticClass:"img-layer"},[n("md-button",{staticClass:"md-icon-button add-file-close",on:{click:t.clear}},[n("md-icon",[t._v("close")])],1),n("img",{attrs:{src:t.thumb,alt:""}})],1):t._e(),n("md-button",{staticClass:"md-icon-button add-file"},[n("md-icon",[t._v("insert_photo")]),n("input",{staticClass:"file-hidden",attrs:{type:"file",accept:"image/*"},on:{change:t.handleChange}})],1),n("md-field",[n("label",[t._v("입력해주세요")]),n("md-input",{model:{value:t.userWrite,callback:function(e){t.userWrite=e},expression:"userWrite"}})],1),n("md-button",{staticClass:"send md-raised md-accent",attrs:{disabled:t.sendLoad},on:{click:t.sendMsg}},[n("md-icon",{staticClass:"md-primary"},[t._v("send")]),n("span",{staticClass:"text"},[t._v("SEND")])],1)],1)},O=[],T=n("325c"),w={name:"MessageForm",data:function(){return{userWrite:"",thumb:null,addFile:null,sendLoad:!1}},created:function(){var t=this;kt.$on("sendResult",function(){t.sendcomplete()})},methods:{handleChange:function(t){var e=this;if(t.target.value){var n=new FileReader;n.readAsDataURL(t.target.files[0]),n.onload=function(){e.thumb=n.result},this.addFile=t.target.files[0]}},clear:function(){this.addFile="",this.thumb=""},sendMsg:function(){var t={text:this.userWrite,today:Object(T["d"])(new Date),type:0};if(this.addFile&&(t.addFile=this.addFile),""===this.userWrite){var e={message:"메세지를 입력해주세요"};return this.$run("dialogAlert",e),!0}this.sendLoad=!0,kt.$emit("sendMessage",t)},sendcomplete:function(){this.userWrite="",this.thumb=null,this.addFile=null,this.sendLoad=!1}}},y=w,R=(n("efc5"),Object(d["a"])(y,S,O,!1,null,"091fb58c",null)),A=R.exports,C=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("md-toolbar",{staticClass:"md-primary chat-header"},[n("div",{staticClass:"md-toolbar-row"},[n("div",{staticClass:"md-toolbar-section-start"},[n("md-button",{staticClass:"md-icon-button",on:{click:t.historyBack}},[n("md-icon",[t._v("arrow_back")])],1)],1),n("div",{staticClass:"md-toolbar-section-end"},[t.alarm>0?n("md-badge",{attrs:{"md-content":t.alarm}},[n("md-button",{staticClass:"md-icon-button"},[n("md-icon",[t._v("notifications")])],1)],1):t._e(),n("md-button",{staticClass:"md-accent",on:{click:t.memberJoin}},[n("md-icon",[t._v("people")]),t._v(" \n        다른 멤버 초대\n      ")],1)],1)])])},k=[],M={name:"MsgHeader",data:function(){return{selectedEmployee:"dsadasd"}},props:{alarm:{default:0,type:Number},name:{type:String}},methods:{historyBack:function(){this.$router.go(-1)},memberJoin:function(){this.$run("invite")}}},x=M,G=Object(d["a"])(x,C,k,!1,null,null,null),L=G.exports,I=n("2f62"),j=["login"],N={name:"app",components:{Footer:g,Header:h,MessageForm:A,MsgHeader:L},data:function(){return{name:"",onepage:!1}},computed:Object(i["a"])({classes:function(){return{isOnepage:{onepage:this.onepage}}}},Object(I["c"])({alarm:function(t){return t.alarm},popupAlert:function(t){return t.popupAlert},popupConfirm:function(t){return t.popupConfirm}})),watch:{$route:function(t,e){this.$run("getDeviceHeight",window.innerHeight),this.routeUpdate(t,e)}},methods:{routeUpdate:function(t,e){var n=this.$route.name;if(this.onepage=j.includes(n),null===e.name)return!0;"message"===t.name&&"list"===e.name&&"message"===n?this.name="message":"list"===t.name&&"message"===e.name&&"list"===n?this.name="list":this.name="none"}}},U=N,D=(n("5c0b"),Object(d["a"])(U,o,c,!1,null,null,null)),H=D.exports,P=n("43f9"),Q=n.n(P),F=n("75fc"),B=n("8c4f"),$=n("8aa5"),W=n.n($),z=n("795b"),Z=n.n(z),J=(n("96cf"),n("f499")),V=n.n(J),q=n("bd86"),K=n("5176"),Y=n.n(K),X=(n("ac6a"),n("a49b")),tt=n("b0b0"),et={};X["a"].forEach(function(t){var e;et=Y()(et,(e={},Object(q["a"])(e,tt["d"]["".concat(t,"_REQ_WAIT")],function(t){t.ready=!0}),Object(q["a"])(e,"".concat(t,"_REQ_SUCCESS"),function(t){t.ready=!1}),Object(q["a"])(e,"".concat(t,"_REQ_FAIL"),function(t){t.ready=!1}),e))});var nt,at,rt,ot,ct=Object(i["a"])({},et,(a={},Object(q["a"])(a,tt["d"].SET_AUTH,function(t,e){t.auth=e}),Object(q["a"])(a,tt["d"].SESSION_AUTH,function(t,e){t.auth=e}),Object(q["a"])(a,tt["d"].SESSION_OUT,function(t,e){t.auth=e}),Object(q["a"])(a,tt["d"].SET_INVITE,function(t,e){t.invite=e}),Object(q["a"])(a,tt["d"].DEVICE_HEIGHT,function(t,e){t.height=e}),Object(q["a"])(a,tt["d"].ALARM_ON,function(t,e){t.alarm=e}),Object(q["a"])(a,tt["d"].POPUP_ALERT,function(t,e){t.popupAlert=Object(i["a"])({isShow:!0},e)}),Object(q["a"])(a,tt["d"].POPUP_CONFIRM,function(t,e){t.popupConfirm=Object(i["a"])({isShow:!0},e)}),a)),it=n("b112"),ut=n.n(it),st={memberList:null},mt={GET_MEMBER:function(t,e){t.memberList=e}},lt={SET_FILTER:function(){return function(t,e){for(var n=JSON.parse(V()(t)),a=0,r=e.length;a<r;a+=1)n[e[a]].disabled=!0;return n}}},dt={GET_MEMBER:regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!st.memberList){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,Object(it["put"])(tt["d"].GET_MEMBER_REQ_WAIT);case 4:return t.next=6,Object(it["call"])(function(){return new Z.a(function(t){W.a.database().ref("myChat/users").on("value",function(n){var a=n.val(),r={};for(var o in a)r[o]=a[o];a?(e.commit(tt["c"].GET_MEMBER,r),e.commit(tt["d"].GET_MEMBER_REQ_SUCCESS),t(r)):(e.commit(tt["d"].GET_MEMBER_REQ_FAIL),t(null))})})});case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}},t)}),SET_JOIN:regeneratorRuntime.mark(function t(){var e,n,a,r=arguments;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=r[1],n=e.length,a={},t.next=3,Object(it["put"])(tt["d"].SET_JOIN_REQ_WAIT);case 3:return t.next=5,Object(it["call"])(function(){return new Z.a(function(t){2===n?W.a.database().ref("myChat/private/".concat(e[1])).child(e[0]).once("value").then(function(n){n.val()?a={hasRoom:!0,key:n.val()}:(a.hasRoom=!1,a.key=W.a.database().ref("myChat/private/".concat(e[1])).push().key,W.a.database().ref("myChat/private/".concat(e[1])).child(e[0]).set(a.key),W.a.database().ref("myChat/private/".concat(e[0])).child(e[1]).set(a.key)),t(a)}):(a.hasRoom=!1,a.key=W.a.database().ref().push().key,t(a))})});case 5:if(a=t.sent,!a.hasRoom){t.next=12;break}return t.next=9,Object(it["put"])(tt["d"].SET_JOIN_REQ_SUCCESS);case 9:return t.abrupt("return",a.key);case 12:return t.next=14,Object(it["put"])(tt["d"].SET_JOIN_REQ_SUCCESS);case 14:return t.next=16,Object(it["call"])(function(){return new Z.a(function(t){var r={state:0,join:e,text:"방이 개설됨"},o=new Date;o=Object(T["d"])(o);for(var c=0;c<n;c+=1)W.a.database().ref("myChat/list/".concat(e[c])).child(a.key).update(r);var i={};i.members=e,i.item=[{write:"admin",text:"방이 개설됨",type:3}],i.date=o,W.a.database().ref("myChat/room/".concat(a.key)).set(i),t(a.key)})});case 16:return t.abrupt("return",t.sent);case 17:case"end":return t.stop()}},t)})},ft={namespaced:!0,state:st,actions:dt,getters:lt,rootMutations:ct,mutations:mt},ht=n("3b8d"),pt={roomList:null,message:null,oldMsg:null,progress:0,chatMember:null,chatDate:null,latest:!1},Et={GET_ROOMLIST:function(t,e){t.roomList=e},GET_MESSAGE:function(t,e){t.message=e},SET_LATEST:function(t,e){t.latest=e},GET_OLD_MESSAGE:function(t,e){t.oldMsg=e},SET_PROGRESS:function(t,e){t.progress=e},GET_CHAT_MEMBER:function(t,e){t.chatMember=e},GET_CHAT_DATE:function(t,e){t.chatDate=e}},bt={GET_ROOMLIST:regeneratorRuntime.mark(function t(e,n){var a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!e.state.roomList){t.next=2;break}return t.abrupt("return",!0);case 2:return t.next=4,Object(it["put"])(tt["d"].GET_ROOMLIST_REQ_WAIT);case 4:return t.next=6,Object(it["call"])(function(){return new Z.a(function(){var t=e.rootState.auth.uid;nt=W.a.database().ref("myChat/list/".concat(t)),nt.on("value",function(t){var e=t.val();if(e){var r=function(t){for(var e={},a=0,r=t.length;a<r;a+=1){var o=t[a];e[o]=n[o]}return e};for(var o in e)e[o].join=r(e[o].join);a.commit(tt["a"].GET_ROOMLIST,e),a.commit(tt["d"].GET_ROOMLIST_REQ_SUCCESS)}else a.commit(tt["a"].GET_ROOMLIST,null),a.commit(tt["d"].GET_ROOMLIST_REQ_FAIL)})})});case 6:case"end":return t.stop()}},t)}),GET_MESSAGE:regeneratorRuntime.mark(function t(){var e=this,n=arguments;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return at&&at.off("value"),t.next=3,Object(it["put"])(tt["d"].GET_MESSAGE_REQ_WAIT);case 3:return t.next=5,Object(it["call"])(function(){return new Z.a(function(){var t={},a=n[1],r=e.state.chat.chatDate;if(W.a.database().ref("myChat/alarm/".concat(e.state.auth.uid,"/").concat(a.key)).set(0),t=JSON.parse(localStorage.getItem("myChatMessage")),null===t){var o={};o[a.key]={},o[a.key][a.today]={},t=o}t[a.key]||(t[a.key]={},t[a.key][a.today]={}),r!==a.today&&(W.a.database().ref("myChat/room/".concat(a.key,"/date")).set(a.today),W.a.database().ref("myChat/room/".concat(a.key,"/item")).set([{text:a.today,type:3,write:"admin"}])),at=W.a.database().ref("myChat/room/".concat(a.key,"/item")),at.on("value",function(n){function o(){return c.apply(this,arguments)}function c(){return c=Object(ht["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:t.t0=regeneratorRuntime.keys(i);case 1:if((t.t1=t.t0()).done){t.next=10;break}if(e=t.t1.value,void 0===i[e].unread){t.next=8;break}if(!i[e].unread[this.state.auth.uid]){t.next=8;break}return i[e].unread[this.state.auth.uid]=0,t.next=8,W.a.database().ref("myChat/room/".concat(a.key,"/item/").concat(e,"/unread/").concat(this.state.auth.uid)).set(0);case 8:t.next=1;break;case 10:return t.next=12,this.commit(tt["a"].GET_MESSAGE,i);case 12:return t.next=14,this.commit(tt["d"].GET_MESSAGE_REQ_SUCCESS);case 14:case"end":return t.stop()}},t,this)})),c.apply(this,arguments)}var i=n.val();i?(r===a.today&&(t[a.key][a.today]=i),o.call(e),localStorage.setItem("myChatMessage",V()(t))):e.commit(tt["d"].GET_MESSAGE_REQ_FAIL)}),W.a.database().ref("myChat/room/".concat(a.key,"/isLogin/").concat(e.state.auth.uid)).set(1)})});case 5:case"end":return t.stop()}},t)}),ROOMOUT:regeneratorRuntime.mark(function t(){var e=this,n=arguments;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(it["call"])(function(){return new Z.a(function(){W.a.database().ref("myChat/room/".concat(n[1],"/isLogin/").concat(e.state.auth.uid)).set(0)})});case 2:case"end":return t.stop()}},t)}),GET_OLD_MESSAGE:regeneratorRuntime.mark(function t(){var e,n,a,r,o,c=arguments;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(it["put"])(tt["d"].GET_OLD_MESSAGE_REQ_WAIT);case 2:if(e=localStorage.getItem("myChatMessage"),n=c[1],!e){t.next=12;break}for(o in a=JSON.parse(e),r={},a[n.key])o!=n.today&&(r[o]=a[n.key][o]);return t.next=8,Object(it["put"])(tt["a"].GET_OLD_MESSAGE,r);case 8:return t.next=10,Object(it["put"])(tt["d"].GET_OLD_MESSAGE_REQ_SUCCESS);case 10:t.next=14;break;case 12:return t.next=14,Object(it["put"])(tt["d"].GET_OLD_MESSAGE_REQ_FAIL);case 14:case"end":return t.stop()}},t)}),SET_LATEST:regeneratorRuntime.mark(function t(){var e,n=this,a=arguments;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=a[1].key,t.next=3,Object(it["call"])(function(){return new Z.a(function(){ot&&ot.off("value"),ot=W.a.database().ref("myChat/room/".concat(e,"/latest")),ot.on("value",function(t){t.val()&&n.commit(tt["a"].SET_LATEST,t.val())})})});case 3:case"end":return t.stop()}},t)}),REMOVE_LATEST:regeneratorRuntime.mark(function t(){var e=this,n=arguments;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(it["call"])(function(){return new Z.a(function(){W.a.database().ref("myChat/room/".concat(n[1],"/latest")).set(!1),e.commit(tt["a"].SET_LATEST,!1)})});case 2:case"end":return t.stop()}},t)}),SEND_MESSAGE:regeneratorRuntime.mark(function t(){var e,n,a,r,o,c,u,s,m,l,d,f,h,p,E,b,_,v=arguments;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return b=function(){return b=Object(ht["a"])(regeneratorRuntime.mark(function t(e){var n,a,r,o,c,i,u,s,m;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:n=e.myuid,a=e.chatMember,r=e.key,o=e.text,c={},i=0,u=a.length;case 2:if(!(i<u)){t.next=18;break}if(W.a.database().ref("myChat/list/".concat(a[i],"/").concat(r,"/text")).set(o),n===a[i]){t.next=15;break}return t.next=7,W.a.database().ref("myChat/room/".concat(r,"/isLogin/").concat(a[i])).once("value").then(function(t){return t.val()});case 7:if(s=t.sent,1===s){t.next=15;break}return c[a[i]]=1,t.next=12,W.a.database().ref("myChat/alarm/".concat(a[i],"/").concat(r)).once("value").then(function(t){return t.val()||0});case 12:return m=t.sent,t.next=15,W.a.database().ref("myChat/alarm/".concat(a[i],"/").concat(r)).set(m+1);case 15:i+=1,t.next=2;break;case 18:W.a.database().ref("myChat/room/".concat(r,"/item/").concat(d.key,"/unread")).update(c);case 19:case"end":return t.stop()}},t)})),b.apply(this,arguments)},E=function(t){return b.apply(this,arguments)},e=v[1],n=e.type,a=e.write,r=e.today,o=e.key,c=e.text,u=e.path,s={type:n,text:c,write:a},m=this.state.chat.chatMember,l=this.state.chat.chatDate,d="",r=new Date,r=Object(T["d"])(r),Object(T["b"])(c)&&(s.text=Object(T["c"])(c),s.vhtml=!0),1===n&&(s.path=u),l!==r?(f={},h=W.a.database().ref("myChat/room").push(),p=[{text:r,type:3,write:"admin"}],h=h.getKey(),f[h]=s,W.a.database().ref("myChat/room/".concat(o,"/date")).set(r),W.a.database().ref("myChat/room/".concat(o,"/item")).set(Object(i["a"])({},p,f))):d=W.a.database().ref("myChat/room/".concat(o,"/item")).push(s),W.a.database().ref("myChat/room/".concat(o,"/latest")).set(s),_={myuid:this.state.auth.uid,chatMember:m,key:o,text:c},E(_),t.next=13,Object(it["put"])(tt["d"].SEND_MESSAGE_REQ_SUCCESS);case 13:case"end":return t.stop()}},t,this)}),ADD_IMAGE:regeneratorRuntime.mark(function t(){var e,n=this,a=arguments;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=a[1],t.next=3,Object(it["call"])(function(){return new Z.a(function(t){var a=W.a.storage().ref("myChat/".concat(e.name)),r=a.put(e);r.on("state_changed",function(t){var e=t.bytesTransferred/t.totalBytes*100;n.commit(tt["a"].SET_PROGRESS,e)},function(e){t(e.message)},function(){r.snapshot.ref.getDownloadURL().then(function(e){t(e)})})})});case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t)}),GET_CHAT_MEMBER:regeneratorRuntime.mark(function t(){var e,n=this,a=arguments;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=a[1],t.next=3,Object(it["call"])(function(){return new Z.a(function(){W.a.database().ref("myChat/room/".concat(e.key,"/members")).once("value").then(function(t){n.commit(tt["a"].GET_CHAT_MEMBER,t.val())})})});case 3:case"end":return t.stop()}},t)}),GET_CHAT_DATE:regeneratorRuntime.mark(function t(){var e,n=this,a=arguments;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=a[1],rt&&rt.off("value"),t.next=4,Object(it["call"])(function(){return new Z.a(function(t){rt=W.a.database().ref("myChat/room/".concat(e.key,"/date")),rt.on("value",function(e){n.commit(tt["a"].GET_CHAT_DATE,e.val()),t(!0)})})});case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}},t)})},_t={namespaced:!0,state:pt,actions:bt,rootMutations:ct,mutations:Et},vt={ready:!1,auth:null,height:null,popupAlert:{isShow:!1,message:null},popupConfirm:{isShow:!1,name:null,message:null,action:null},invite:!1,alarm:{item:{},total:0}},gt={loginEmail:regeneratorRuntime.mark(function t(e,n){var a,r,o=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return a=n.id,r=n.pw,t.next=3,Object(it["put"])(tt["d"].LOGIN_EMAIL_REQ_WAIT);case 3:return t.next=5,Object(it["call"])(function(){return new Z.a(function(t){W.a.auth().signInWithEmailAndPassword(a,r).catch(function(e){t(Object(i["a"])({},e,{state:!1})),o.commit(tt["d"].LOGIN_EMAIL_REQ_FAIL)}).then(function(e){e&&(t({state:!0}),o.commit(tt["d"].LOGIN_EMAIL_REQ_SUCCESS))})})});case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}},t)}),createMailID:regeneratorRuntime.mark(function t(e,n){var a,r,o,c=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return a=n.id,r=n.pw,o=n.name,t.next=3,Object(it["put"])(tt["d"].CREATE_AUTH_REQ_WAIT);case 3:return t.next=5,Object(it["call"])(function(){return new Z.a(function(t){W.a.auth().createUserWithEmailAndPassword(a,r).catch(function(e){c.commit(tt["d"].CREATE_AUTH_REQ_FAIL),t(Object(i["a"])({},e,{state:!1}))}).then(function(e){if(e){var n=e.user.uid,r={};r[n]={email:a,displayName:o,photoURL:"http://placehold.it/60x60",uid:n},W.a.database().ref("myChat/users").update(r),c.commit(tt["d"].CREATE_AUTH_REQ_SUCCESS),t({state:!0})}})})});case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}},t)}),loginGoogle:regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(it["put"])(tt["d"].LOGIN_GOOGLE_AUTH_REQ_WAIT);case 2:return t.next=4,Object(it["call"])(function(){return new Z.a(function(t){var n=new W.a.auth.GoogleAuthProvider;n.addScope("https://www.googleapis.com/auth/contacts.readonly"),W.a.auth().signInWithPopup(n).then(function(n){if(n){var a=n.user,r=a.displayName,o=a.uid,c=a.email,i=a.photoURL;t(Y()({displayName:r,uid:o,email:c,photoURL:i},{state:!0})),W.a.database().ref("myChat/users").child(o).set({displayName:r,uid:o,email:c,photoURL:i}),e.commit(tt["d"].LOGIN_GOOGLE_AUTH_REQ_SUCCESS)}}).catch(function(n){t(Object(i["a"])({},n,{state:!1})),e.commit(tt["d"].LOGIN_GOOGLE_AUTH_REQ_FAIL)})})});case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}},t)}),getSession:regeneratorRuntime.mark(function t(e){var n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return n=e.state.auth,t.next=3,Object(it["call"])(function(){return new Z.a(function(t){null===n?W.a.auth().onAuthStateChanged(function(n){n?W.a.database().ref("myChat/users/".concat(n.uid)).once("value").then(function(n){e.commit(tt["d"].SESSION_AUTH,n.val()),t(n.val())}):e.commit(tt["d"].SESSION_OUT,null)}):t(n)})});case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t)}),logout:regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(it["call"])(function(){return new Z.a(function(t){W.a.auth().signOut().then(function(){t(!0),setTimeout(function(){e.commit(tt["d"].SET_AUTH,null)},500)}).catch(function(e){t(!1,e)})})});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t)}),dialogAlert:regeneratorRuntime.mark(function t(){var e=arguments;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(it["put"])(tt["d"].POPUP_ALERT,e[1]);case 2:case"end":return t.stop()}},t)}),dialogConfirm:regeneratorRuntime.mark(function t(){var e=arguments;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(it["put"])(tt["d"].POPUP_CONFIRM,e[1]);case 2:case"end":return t.stop()}},t)}),invite:regeneratorRuntime.mark(function t(){var e,n=arguments;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=void 0===n[1]?!this.state.invite:n[1],t.next=3,Object(it["put"])(tt["d"].SET_INVITE,e);case 3:case"end":return t.stop()}},t,this)}),getDeviceHeight:regeneratorRuntime.mark(function t(){var e=arguments;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(it["put"])(tt["d"].DEVICE_HEIGHT,e[1]);case 2:case"end":return t.stop()}},t)})};r["default"].use(I["a"]);var St=new I["a"].Store({state:vt,actions:gt,mutations:ct,modules:{chat:_t,member:ft}}),Ot=St;r["default"].use(B["a"]),r["default"].component("router-link",r["default"].options.components.RouterLink),r["default"].component("router-view",r["default"].options.components.RouterView);var Tt,wt=[{name:"login",path:"/login",component:"/Login"},{name:"list",path:"/list",component:"/List"},{name:"member",path:"/member",component:"/Member"},{name:"ready",path:"/ready",component:"/Ready"},{name:"message",path:"/message/:id",component:"/Message"},{name:"error",path:"*",component:"/Error"}],yt=[{path:"/",exact:"exact",redirect:"login"}],Rt=[].concat(Object(F["a"])(wt.map(function(t){var e=t.name,a=t.path,r=t.component;return{path:a,name:e,component:function(){return n("5d57")("./container".concat(r))}}})),yt),At=new B["a"]({mode:"history",base:"/chat",routes:Rt});At.beforeEach(function(t,e,n){W.a.auth().onAuthStateChanged(function(e){e?(Tt&&Tt.off("value"),Tt=W.a.database().ref("myChat/alarm/".concat(e.uid)),Tt.on("value",function(t){var e=t.val(),n=0;if(e){for(var a in e)n+=e[a];e.total=n,Ot.commit("ALARM_ON",e)}else Ot.commit("ALARM_ON",{item:null,total:0})}),Ot.state.auth?"login"===t.name?n("/member"):n():W.a.database().ref("myChat/users/".concat(e.uid)).once("value").then(function(e){Ot.commit("SESSION_AUTH",e.val()),"login"===t.name?n("/member"):n()})):"login"===t.name?n():n("/login")})});var Ct=At;n("51de"),n("e094");n.d(e,"EventBus",function(){return kt});var kt=new r["default"];r["default"].use(ut.a,{store:Ot}),W.a.initializeApp(X["b"]),r["default"].use(Q.a),new r["default"]({router:Ct,store:Ot,render:function(t){return t(H)}}).$mount("#app")},"5c0b":function(t,e,n){"use strict";var a=n("5e27"),r=n.n(a);r.a},"5d57":function(t,e,n){var a={"./container/Error":["c851","chunk-2567a75f"],"./container/Error.vue":["c851","chunk-2567a75f"],"./container/List":["9788","chunk-bf8b74c8"],"./container/List.vue":["9788","chunk-bf8b74c8"],"./container/Login":["16b7","chunk-50dcc184"],"./container/Login.vue":["16b7","chunk-50dcc184"],"./container/Member":["1c8f","chunk-0714cbc6"],"./container/Member.vue":["1c8f","chunk-0714cbc6"],"./container/Message":["c9ac","chunk-e123192c"],"./container/Message.vue":["c9ac","chunk-e123192c"],"./container/Ready":["d8c9","chunk-04869cf8"],"./container/Ready.vue":["d8c9","chunk-04869cf8"]};function r(t){var e=a[t];return e?n.e(e[1]).then(function(){var t=e[0];return n(t)}):Promise.resolve().then(function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e})}r.keys=function(){return Object.keys(a)},r.id="5d57",t.exports=r},"5e27":function(t,e,n){},a054:function(t,e,n){},a49b:function(t,e,n){"use strict";n.d(e,"b",function(){return a}),n.d(e,"a",function(){return r});var a={apiKey:"AIzaSyBwc5tkZM3fEQcyPC1-HfguTbIt8woO9iA",authDomain:"shushu-cb26c.firebaseapp.com",databaseURL:"https://shushu-cb26c.firebaseio.com",storageBucket:"shushu-cb26c.appspot.com"},r=["INIT","LOGIN_EMAIL","LOGIN_GOOGLE_AUTH","CREATE_AUTH","GET_MEMBER","GET_ROOMLIST","GET_MESSAGE","GET_OLD_MESSAGE","SET_JOIN","SEND_MESSAGE"]},b0b0:function(t,e,n){"use strict";n.d(e,"c",function(){return s}),n.d(e,"a",function(){return m}),n.d(e,"b",function(){return l});var a=n("cebc"),r=n("bd86"),o=n("5176"),c=n.n(o),i=(n("ac6a"),n("a49b")),u={};i["a"].forEach(function(t){var e;u=c()(u,(e={},Object(r["a"])(e,"".concat(t,"_REQ_WAIT"),"".concat(t,"_REQ_WAIT")),Object(r["a"])(e,"".concat(t,"_REQ_SUCCESS"),"".concat(t,"_REQ_SUCCESS")),Object(r["a"])(e,"".concat(t,"_REQ_FAIL"),"".concat(t,"_REQ_FAIL")),e))}),e["d"]=Object(a["a"])({},u,{SET_AUTH:"SET_AUTH",SESSION_AUTH:"SESSION_AUTH",SESSION_OUT:"SESSION_OUT",SET_INVITE:"SET_INVITE",DEVICE_HEIGHT:"DEVICE_HEIGHT",POPUP_ALERT:"POPUP_ALERT",POPUP_CONFIRM:"POPUP_CONFIRM",ALARM_ON:"ALARM_ON"});var s={GET_MEMBER:"member/GET_MEMBER",SET_JOIN:"member/SET_JOIN",SET_FILTER:"member/SET_FILTER"},m={GET_ROOMLIST:"chat/GET_ROOMLIST",GET_MESSAGE:"chat/GET_MESSAGE",GET_OLD_MESSAGE:"chat/GET_OLD_MESSAGE",SEND_MESSAGE:"chat/SEND_MESSAGE",ADD_IMAGE:"chat/ADD_IMAGE",SET_PROGRESS:"chat/SET_PROGRESS",GET_CHAT_MEMBER:"chat/GET_CHAT_MEMBER",GET_CHAT_DATE:"chat/GET_CHAT_DATE",ROOMOUT:"chat/ROOMOUT",SET_LATEST:"chat/SET_LATEST",REMOVE_LATEST:"chat/REMOVE_LATEST"},l={"auth/wrong-password":"비밀번호가 잘못 되었습니다","auth/user-not-found":"아이디가 잘못 되었습니다.","auth/email-already-in-use":"해당 이메일 사용되고 있습니다.","auth/popup-closed-by-user":"계정선택 팝업창을 닫아 로그인 화면으로 돌아갑니다."}},e7bd:function(t,e,n){"use strict";var a=n("1a80"),r=n.n(a);r.a},efc5:function(t,e,n){"use strict";var a=n("a054"),r=n.n(a);r.a}});
//# sourceMappingURL=app.769827e1.js.map