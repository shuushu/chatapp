(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e123192c","chunk-7134c0ec"],{"1c8f":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"page",class:{invite:t.chatMember},style:"height:"+this.winh+"px",attrs:{id:"memberList"}},[t.isLoading?i("div",{staticClass:"wrap-center"},[i("md-progress-spinner",{attrs:{"md-diameter":50,"md-mode":"indeterminate"}})],1):i("div",[null===t.member?i("div",{staticClass:"md-empty-state-wrap"},[i("md-empty-state",{staticClass:"md-primary",attrs:{"md-icon":"sentiment_dissatisfied","md-label":"Nothing in Done","md-description":"대화 가능 한 멤버 없음"}})],1):i("md-list",t._l(t.fetchData,function(e,a){return i("div",{key:a},[t.auth.uid!=a?i("md-list-item",{staticClass:"md-triple-line md-dense"},[i("md-checkbox",{attrs:{disabled:e.disabled,value:e.uid},model:{value:t.checkArr,callback:function(e){t.checkArr=e},expression:"checkArr"}}),i("md-avatar",[i("img",{attrs:{src:e.photoURL,alt:e.displayName}})]),i("div",{staticClass:"md-list-item-text"},[i("span",{staticClass:"title"},[t._v(t._s(e.displayName))]),i("span",{staticClass:"desc"},[t._v(t._s(e.email))])])],1):t._e()],1)}),0),i("div",{class:{btnWrap:t.chatMember}},[t.checkArr.length>0?i("md-button",{staticClass:"join md-raised md-accent",on:{click:t.memberJoin}},[i("md-icon",{staticClass:"md-primary"},[t._v("people")]),t._v(" JOIN\n        ")],1):t._e(),t.chatMember?i("md-button",{staticClass:"join md-raised md-primary",on:{click:t.toggle}},[i("md-icon",{staticClass:"md-primary"},[t._v("cancel")]),t._v(" cancel\n        ")],1):t._e()],1)],1)])},s=[],n=i("cebc"),r=(i("c5f6"),i("2f62")),c=i("b0b0"),o=i("325c"),l={name:"Member",data:function(){return{checkArr:[]}},props:{chatMember:{type:Object},winh:{type:Number,default:null}},computed:Object(n["a"])({fetchData:function(){return this.chatMember?this.filter(this.member,this.chatMember):this.member}},Object(r["d"])({auth:function(t){return t.auth},isLoading:function(t){return t.ready},member:function(t){return t.member.memberList}}),Object(r["c"])({filter:c["c"].SET_FILTER})),created:function(){this.getMember()},methods:Object(n["a"])({},Object(r["b"])({getMember:c["c"].GET_MEMBER,setJoin:c["c"].SET_JOIN}),{toggle:function(){this.$store.dispatch("invite")},memberJoin:function(){var t=this;if(this.chatMember)for(var e in this.$store.dispatch("dialogAlert",{message:"초대하였습니다."}),this.chatMember)this.checkArr.push(e);else this.checkArr.push(this.auth.uid);this.setJoin(this.checkArr).then(function(e){t.$router.push({name:"message",params:{id:e}});var i=Object(o["d"])(new Date);if(t.chatMember){var a={key:e,today:i};null===t.member?t.$router.push("/list"):t.$store.dispatch(c["a"].GET_CHAT_DATE,a).then(function(e){e&&(t.$store.dispatch(c["a"].GET_MESSAGE,a),t.$store.dispatch(c["a"].GET_OLD_MESSAGE,a),t.toggle())})}})}})},u=l,m=(i("8cb3"),i("2877")),d=Object(m["a"])(u,a,s,!1,null,null,null);e["default"]=d.exports},"3f48":function(t,e,i){"use strict";var a=i("e729"),s=i.n(a);s.a},5118:function(t,e,i){(function(t){var a="undefined"!==typeof t&&t||"undefined"!==typeof self&&self||window,s=Function.prototype.apply;function n(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new n(s.call(setTimeout,a,arguments),clearTimeout)},e.setInterval=function(){return new n(s.call(setInterval,a,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},n.prototype.unref=n.prototype.ref=function(){},n.prototype.close=function(){this._clearFn.call(a,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},i("6017"),e.setImmediate="undefined"!==typeof self&&self.setImmediate||"undefined"!==typeof t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!==typeof self&&self.clearImmediate||"undefined"!==typeof t&&t.clearImmediate||this&&this.clearImmediate}).call(this,i("c8ba"))},6017:function(t,e,i){(function(t,e){(function(t,i){"use strict";if(!t.setImmediate){var a,s=1,n={},r=!1,c=t.document,o=Object.getPrototypeOf&&Object.getPrototypeOf(t);o=o&&o.setTimeout?o:t,"[object process]"==={}.toString.call(t.process)?h():p()?f():t.MessageChannel?v():c&&"onreadystatechange"in c.createElement("script")?g():b(),o.setImmediate=l,o.clearImmediate=u}function l(t){"function"!==typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),i=0;i<e.length;i++)e[i]=arguments[i+1];var r={callback:t,args:e};return n[s]=r,a(s),s++}function u(t){delete n[t]}function m(t){var e=t.callback,a=t.args;switch(a.length){case 0:e();break;case 1:e(a[0]);break;case 2:e(a[0],a[1]);break;case 3:e(a[0],a[1],a[2]);break;default:e.apply(i,a);break}}function d(t){if(r)setTimeout(d,0,t);else{var e=n[t];if(e){r=!0;try{m(e)}finally{u(t),r=!1}}}}function h(){a=function(t){e.nextTick(function(){d(t)})}}function p(){if(t.postMessage&&!t.importScripts){var e=!0,i=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=i,e}}function f(){var e="setImmediate$"+Math.random()+"$",i=function(i){i.source===t&&"string"===typeof i.data&&0===i.data.indexOf(e)&&d(+i.data.slice(e.length))};t.addEventListener?t.addEventListener("message",i,!1):t.attachEvent("onmessage",i),a=function(i){t.postMessage(e+i,"*")}}function v(){var t=new MessageChannel;t.port1.onmessage=function(t){var e=t.data;d(e)},a=function(e){t.port2.postMessage(e)}}function g(){var t=c.documentElement;a=function(e){var i=c.createElement("script");i.onreadystatechange=function(){d(e),i.onreadystatechange=null,t.removeChild(i),i=null},t.appendChild(i)}}function b(){a=function(t){setTimeout(d,0,t)}}})("undefined"===typeof self?"undefined"===typeof t?this:t:self)}).call(this,i("c8ba"),i("43622"))},"69c2":function(t,e,i){"use strict";var a=i("6ebc"),s=i.n(a);s.a},"6ebc":function(t,e,i){},"8cb3":function(t,e,i){"use strict";var a=i("f45f"),s=i.n(a);s.a},c9ac:function(t,e,i){"use strict";i.r(e);var a,s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"page",class:{inviteWrap:t.invite},attrs:{id:"message"}},[i("div",{staticClass:"message-wrap",style:"min-height:"+(this.$route.params.h-80)+"px"},[t._l(t.oldMsg,function(e,a){return i("div",{key:"old-"+a,staticClass:"old-items"},t._l(e,function(e,a){return i("div",{key:"old-item-"+a,staticClass:"talk-items",class:t.isWrite(e.write)},["notice"!=t.isWrite(e.write)?i("div",{staticClass:"img-wrap"},[i("md-avatar",[i("img",{attrs:{src:t.mappingAvatar(e.write),alt:t.mappingUserName(e.write)}})]),i("span",{staticClass:"name"},[t._v(t._s(t.mappingUserName(e.write)))])],1):t._e(),i("div",{staticClass:"talk-wrap"},[i("Talkbox",{class:t.isWrite(e.write)},[1===e.type?i("div",{staticClass:"addfile-image"},[i("img",{attrs:{src:e.path,alt:""}})]):t._e(),e.vhtml?i("span",{domProps:{innerHTML:t._s(e.text)}}):i("span",[t._v(t._s(e.text))])])],1)])}),0)}),t._l(t.message,function(e,a,s){return i("div",{key:a,staticClass:"talk-items",class:t.isWrite(e.write)},["notice"!=t.isWrite(e.write)?i("div",{staticClass:"img-wrap"},[i("md-avatar",[i("img",{attrs:{src:t.mappingAvatar(e.write),alt:t.mappingUserName(e.write)}})]),i("span",{staticClass:"name"},[t._v(t._s(t.mappingUserName(e.write)))])],1):t._e(),i("div",{staticClass:"talk-wrap"},[i("Talkbox",{class:t.isWrite(e.write)},[1===e.type?i("div",{staticClass:"addfile-image"},[i("img",{attrs:{src:e.path,alt:""}})]):t._e(),e.vhtml?i("span",{domProps:{innerHTML:t._s(e.text)}}):i("span",[t._v(t._s(e.text))]),0!==e.unread?i("span",{staticClass:"unread"},[t._v("\n                "+t._s(e.unread)+"\n              ")]):t._e(),t.sendWaitCheck(s)?i("md-progress-spinner",{staticClass:"md-accent msgLoading",attrs:{"md-diameter":10,"md-stroke":1,"md-mode":"indeterminate"}}):t._e()],1)],1)])})],2),t.pgr>0&&t.pgr<100?i("div",{staticClass:"upload-progress"},[i("md-progress-spinner",{staticClass:"md-accent",attrs:{"md-mode":"determinate","md-value":t.pgr}})],1):t._e(),i("transition",{attrs:{name:"popmember"}},[t.invite?i("Member",{attrs:{winh:this.$route.params.h,chatMember:t.chatMember.data}}):t._e()],1),i("transition",{attrs:{name:"msgAlarm"}},[!0===t.tipFlag&&!1!==t.roomList?i("div",{staticClass:"alarmLayer",on:{click:function(e){return t.scrollToEnd("pop")}}},[i("div",{staticClass:"wrap"},[i("md-avatar",[i("img",{attrs:{src:t.allMember[t.roomList[this.$route.params.id].lwrite].photoURL,alt:t.allMember[t.roomList[this.$route.params.id].lwrite].displayName}})]),i("span",{staticClass:"name"},[t._v(t._s(t.allMember[t.roomList[this.$route.params.id].lwrite].displayName))]),i("span",{staticClass:"text"},[t._v(t._s(t.roomList[this.$route.params.id].text))])],1)]):t._e()])],1)},n=[],r=(i("96cf"),i("3b8d")),c=i("a4bb"),o=i.n(c),l=i("cebc"),u=i("2f62"),m=i("b0b0"),d=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"talkBox",class:{old:t.old,notice:t.notice,right:t.right}},[i("div",{staticClass:"wrap"},[t._t("default")],2)])},h=[],p={name:"Talkbox",props:{old:{type:Boolean,default:!1},notice:{type:Boolean,default:!1},right:{type:Boolean,default:!1}}},f=p,v=(i("69c2"),i("2877")),g=Object(v["a"])(f,d,h,!1,null,null,null),b=g.exports,y=i("1c8f"),_=i("56d7"),w=i("325c"),T=i("5118"),k={name:"Message",components:{Talkbox:b,Member:y["default"]},data:function(){return{loadOnce:!1,tipFlag:!1,roomkey:null,scrollFlag:!1,sendWait:!1,preview:null}},computed:Object(l["a"])({},Object(u["d"])({invite:function(t){return t.invite},auth:function(t){return t.auth},message:function(t){return t.chat.message},oldMsg:function(t){return t.chat.oldMsg},allMember:function(t){return t.member.memberList},chatMember:function(t){return t.chat.chatMember},chatDate:function(t){return t.chat.chatDate},roomList:function(t){return t.chat.roomList},pgr:function(t){return t.chat.progress}})),watch:{invite:function(t){var e=document.querySelector("body");t?e.style.overflow="hidden":e.removeAttribute("style")},chatMember:function(){if(this.chatMember&&o()(this.chatMember.data).length<=1){var t=document.getElementById("footer");t.style.display="none"}},message:function(){var t=this;Object(T["setTimeout"])(function(){if(t.roomList&&!1!==t.loadOnce&&t.auth.uid!==t.roomList.lwrite){var e=t.scrollToEnd();!1===e&&(t.tipFlag=!0,a&&Object(T["clearTimeout"])(a),a=Object(T["setTimeout"])(function(){t.tipFlag=!1},5e3))}t.loadOnce=!0},1e3)}},destroyed:function(){_["EventBus"].$off("sendMessage"),_["EventBus"].$off("imgPreview"),this.$store.dispatch("chat/SET_JOIN",{type:"OUT",key:this.roomkey});var t=document.querySelector("body");t.removeAttribute("style");var e=document.getElementById("footer");e.removeAttribute("style")},created:function(){var t=this;this.roomkey=this.$route.params.id;var e={key:this.roomkey,today:Object(w["d"])(new Date)};_["EventBus"].$on("sendMessage",function(e){e&&t.sendMsg(e)}),_["EventBus"].$on("imgPreview",function(e){t.preview=e}),null===this.chatMember&&this.$router.push("/list"),this.$store.dispatch(m["a"].GET_CHAT_DATE,e).then(function(i){i&&(t.$store.dispatch(m["a"].GET_MESSAGE,e),t.$run(m["a"].GET_OLD_MESSAGE,e),t.$store.dispatch("chat/SET_JOIN",{type:"IN",key:e.key}))})},updated:function(){var t=this;this.scrollFlag||(Object(T["setTimeout"])(function(){t.scrollToEnd(!0)},600),this.scrollFlag=!0)},beforeRouteEnter:function(t,e,i){t.params.h=window.innerHeight,i()},methods:{sendWaitCheck:function(t){if(this.sendWait){var e=o()(this.message).length;return t===e-1}},sunUnread:function(t){var e=0;for(var i in t)e+=t[i];if(e>0)return e},scrollToEnd:function(t){var e=this.$el.querySelector(".message-wrap"),i=document.querySelector("html"),a=document.querySelector("body"),s=window.innerHeight,n=Object(w["a"])(s,e);return(n||t)&&(i.scrollTop=e.scrollHeight,a.scrollTop=e.scrollHeight,"pop"===t&&(this.tipFlag=!1)),n},historyBack:function(){this.$router.go(-1)},sendMsg:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(e){var i=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.sendWait=!0,e.key=this.$route.params.id,e.write=this.auth.uid,e.addFile&&(e.path=this.preview,e.type=1,_["EventBus"].$emit("sendResult",!0),this.$store.dispatch(m["a"].ADD_IMAGE,e.addFile)),t.next=6,this.$store.dispatch("chat/SEND_MESSAGE2",e).then(function(t){t?(i.sendWait=!1,_["EventBus"].$emit("sendResult",!0),i.scrollToEnd(!0)):(i.sendWait="wait",i.$store.dispatch("dialogAlert",{message:"메세지 전송중 에러 발생"}))});case 6:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),mappingAvatar:function(t){return this.auth.uid===t?this.auth.photoURL:this.allMember[t].photoURL},mappingUserName:function(t){return this.auth.uid===t?this.auth.displayName:"admin"!==t?this.allMember[t].displayName:t},isWrite:function(t){return"admin"===t?"notice":this.auth.uid===t?"left":"right"},clear:function(){this.addFile="",this.thumb=""}}},M=k,E=(i("3f48"),Object(v["a"])(M,s,n,!1,null,null,null));e["default"]=E.exports},e729:function(t,e,i){},f45f:function(t,e,i){}}]);
//# sourceMappingURL=chunk-e123192c.bb1def91.js.map